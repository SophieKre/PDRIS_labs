В виду специфики моего setup'а структура лабы следующая (все пути прописаны от /lab2):  
  - /Dockerfile - Это докер файл для ansible-playbook контейнера в него кладутся конфиги ансибла.
  - /ansible - Папка с конфигами и плейбуками для ансибла
    - /ansible/ansible.cfg - в нем я прописала отключение проверки ключей (у меня не работало подключение по SSH)
    - /ansible/inventory.cfg - в нем я прописала сервер + креды к нему (это креды к контейнеру который запущен у меня локально). В моем случае сервер это docker-контейнер, команду для получения ip адреса контейнера оставлю ниже.
    - /ansible/app.yml - playbook для раскатки приложения. Он скачивает питон + зависимости + запускает сервис.
    - /ansible/nginx.yml - playbook для установки и конфигурирования nginx. В конфиге прописано прокисрование на ip-адрессе сервера поэтому при локальном тестировании нужно поменять ip моего контейнера на адресс вашего сервера/контейнера. Проксирует на порту 80 в порт 8000.
  - /simple_app - простой python сервис написанный на fastapi, предпологает запуск через uvicorn.
    - /simple_app/app.py - непосредственно код сервиса
    - /simple_app/run.sh - скрипт для запуска (используется ansible-playbook'ом)
  - /node/Dockerfile - докерфайл с образом сервиса. При запуске нужно примонтировать директорию приложения в директорию /app (не реализовывала скачивание из git репозитория). Именно этот образ используется как контейнер-сервер. В нем по умолчанию раскрывается 22 порт, чтобы можно было использовать ansible без прокидывания сокетов докера, теперь можно просто по ssh.  
  Команда для запуска сервера (контейнера со "скачаным" сервисом):  
  ```shellsession
    docker run -dit -v ./simple_app:/app -p 80 -p 8000 --name ansible-node ansible-node:v1
  ```
  80 и 8000 порты открываются для доступа к сервису (на самом дела т.к. устанвливается nginx то нужно раскрывать только 80 порт).  
  Команда что-бы узнать локальный ip адресс docker контейнера:  
  ```shellsession
    docker inspect --format={{range .NetworkSettings.Networks}}{{.IPAddress}}{{end}} ansible-node
  ```
  Для выполнения плейбуков используем следующие команды:  
  ```shellsession
    docker run -it ansible-host:v1 ansible-playbook -i inventory.cfg -m ping all
    docker run -it ansible-host:v1 ansible-playbook -i inventory.cfg nginx.yml
    docker run -it ansible-host:v1 ansible-playbook -i inventory.cfg app.yml
  ```
  Первая команда нужна чтобы проверить правильно ли прописан ip адресс и креды для сервера.  
  В этих командах можно использовать другое название контейнера кроме ansible-node (или вообще использовать id контейнера, но по моему так удобнее).  
  После того как все установлено и все playbook'и выполнены, можно попробовать стукнуть в сервис:  
  ```shellsession
    curl -v {server_ip_address}:80
  ```
  
